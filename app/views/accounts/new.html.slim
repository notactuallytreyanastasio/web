.center
  = inline_svg 'tape.svg'

h1 Yearly Membership Fee - $125

.center-form
  = form_for @account, class: 'center-form' do |f|
    ul.fields
      li.field
        = f.label :email, class: 'one-line'
        = f.email_field :email, required: true
      li.field
        = f.label :first_name, class: 'one-line'
        = f.text_field :first_name, required: true
      li.field
        = f.label :last_name, class: 'one-line'
        = f.text_field :last_name, required: true
      li.field
        = f.label :phone_number, class: 'one-line'
        = f.telephone_field :phone_number, required: true
      li.field
        = f.label :address_1, class: 'one-line'
        = f.text_field :address_1, required: true
      li.field
        = f.label :address_2, class: 'one-line'
        = f.text_field :address_2, required: true
      li.field
        = f.label :city, class: 'one-line'
        = f.text_field :city, required: true
      li.field
        = f.label :state, class: 'one-line'
        = f.text_field :state, required: true
      li.field
        = f.label :postal_code, class: 'one-line'
        = f.text_field :postal_code, required: true
      li.field
        = f.label :referrer, class: 'one-line'
        = f.text_field :referrer, required: true
      li.field
        = f.label :profession, class: 'one-line'
        = f.text_field :profession, required: true
      li.field
        = f.label :work_description
        = f.text_area :work_description, required: true
      li.field
        = f.label :how_can_you_help
        = f.text_area :how_can_you_help, required: true
      li.field
        = f.label :how_can_you_be_helped
        = f.text_area :how_can_you_be_helped, required: true
      li.field
        = f.label :website, class: 'one-line'
        = f.url_field :website, required: true
      li.field
        = f.label :birthday, class: 'one-line'
        = f.date_field :birthday, required: true
      li.field
        = f.label :twitter, class: 'one-line'
        = f.text_field :twitter, required: true
      li.field
        = f.label :instagram, class: 'one-line'
        = f.text_field :instagram, required: true
      li.field
        = f.label :facebook, class: 'one-line'
        = f.text_field :facebook, required: true
      li.field
        = f.label :linkedin, class: 'one-line'
        = f.text_field :linkedin, required: true

    = f.hidden_field :payment_method_nonce
    .bt-drop-in-wrapper
      #bt-dropin
    .center-form
      = f.submit 'Join now', data: { disable_with: false }

script[src="https://js.braintreegateway.com/web/dropin/1.18.0/js/dropin.min.js"]
javascript:
  var form = document.querySelector('#new_account');
  var client_token = "#{ @client_token }";
  braintree.dropin.create({
    authorization: client_token,
    container: '#bt-dropin'
  }, function (createErr, instance) {
    form.addEventListener('submit', function (event) {
      event.preventDefault();
      instance.requestPaymentMethod(function (err, payload) {
        if (err) {
          console.log('Error', err);
          return;
        }
        // Add the nonce to the form and submit
        document.querySelector('#account_payment_method_nonce').value = payload.nonce;
        form.submit();
      });
    });
  });
